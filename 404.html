<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Redirecting...</title>
    <script async data-id="101464093" src="//static.getclicky.com/js"></script>
    <script>
          /**
     * Configuration goes here
     */
    var GITHUB_ISSUES_LINK = "https://api.github.com/repos/designontapp/shortener/issues/";
    var PATH_SEGMENTS_TO_SKIP = 0;
    
    var CUSTOM_SLUGS = {
      "notes": "https://example.com/my-notes",
      // Add more custom slugs here
    };
    
    function isUrl(url) {
      return /^https?:\/\/(www\.)?[-a-zA-Z0-9@:%.\+~#=]{2,256}\.[a-z]{2,24}\b([-a-zA-Z0-9@:%\+.~#?&//=])+$/.test(url);
    }
    
    function redirect() {
      var location = window.location;
      var pathSegments = location.pathname.split("/").filter(Boolean);
      var slug = pathSegments[PATH_SEGMENTS_TO_SKIP] || "";
      var homepage = location.protocol + "//" + location.hostname +
        (location.port ? ":" + location.port : "");
    
      // Check if the slug is in CUSTOM_SLUGS
      if (CUSTOM_SLUGS.hasOwnProperty(slug)) {
        location.replace(CUSTOM_SLUGS[slug]);
        return;
      }
    
      var xhr = new XMLHttpRequest();
    
      xhr.onload = function () {
        try {
          var payload = JSON.parse(xhr.response);
          var message = payload.message;
          var title = payload.title;
    
          var url = document.createElement("a");
          url.setAttribute("href", title);
    
          var isInvalidUrl = message === "Not Found" || !title || !isUrl(title) || url.hostname === location.hostname;
    
          if (isInvalidUrl) {
            location.replace(homepage);
          } else {
            location.replace(title);
          }
        } catch (e) {
          location.replace(homepage);
        }
      };
    
      xhr.onerror = function () {
        location.replace(homepage);
      };
      
      xhr.open("GET", GITHUB_ISSUES_LINK + slug);
      xhr.send();
    }
    
    redirect();

    </script>
  </head>
  <body></body>
</html>
